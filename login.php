<?php    session_start();    include("conf/configuration.php");    include("database/Connection.php");    include("functions.php");    if(isset($_SESSION['loggedin']))    {        header("Location: http://" . $SERVER_HOST . "/index.php");    }    $conn = new Connection();    if($_SERVER['REQUEST_METHOD'] == "POST") {        if(isset($_POST['username']) && isset($_POST['password']))        {            if($_POST['security'] == 0)            {                $query = "SELECT * FROM Users WHERE username='" . $_POST['username'] . "' AND password='" . $_POST['password'] ."'";            }            else if($_POST['security'] == 1)            {                $username = sanitize($_POST['username']);                $password = sanitize($_POST['password']);                $query = "SELECT * FROM Users WHERE username='" . $username . "' AND password='" . $password ."'";            }            try{                $conn->executeQuery($query);                $prep = $conn->getQuery();                $rows = $prep->rowCount();                $results = $prep->fetchAll(PDO::FETCH_ASSOC);                if($rows > 0)                {                    $_SESSION['loggedin'] = "OK";                    $_SESSION['username'] = $results[0]['username'];                    $_SESSION['access'] = $results[0]['access'];                    echo("<script>window.location.replace('http://" . $SERVER_HOST . "/index.php');</script>");                }                else                {                    echo("<script>alert('Wrong credentials!')</script>");                }            }            catch(PDOException $e)            {                echo("<script>alert('Error. Query failed.')</script>");            }        }    }?>    <html>    <head>        <meta name="viewport" content="width=device-width, initial-scale=1">        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>        <style>            body {font-family: Arial, Helvetica, sans-serif;}            form {border: 3px solid #f1f1f1;}            input[type=text], input[type=password] {                width: 100%;                padding: 12px 20px;                margin: 8px 0;                display: inline-block;                border: 1px solid #ccc;                box-sizing: border-box;            }            button {                background-color: #4CAF50;                color: white;                padding: 14px 20px;                margin: 8px 0;                border: none;                cursor: pointer;                width: 100%;            }            button:hover {                opacity: 0.8;            }            .cancelbtn {                width: auto;                padding: 10px 18px;                background-color: #f44336;            }            .imgcontainer {                text-align: center;                margin: 24px 0 12px 0;            }            img.avatar {                width: 40%;                border-radius: 50%;            }            .container {                padding: 16px;            }            span.psw {                float: right;                padding-top: 16px;            }            /* Change styles for span and cancel button on extra small screens */            @media screen and (max-width: 300px) {                span.psw {                    display: block;                    float: none;                }                .cancelbtn {                    width: 100%;                }            }            .querydiv            {                border:1px solid black;                text-align: center;                padding:5px;            }        </style>        <title>SQL Injection Site</title>    </head>    <body>    <h2>SQL Injection</h2>    <form method="POST" id="form">        <div class="querydiv">            <div id="query">            </div>        </div>        <div class="container">            <label for="uname"><b>Username</b></label>            <input type="text" placeholder="Enter Username" name="username" id="username" required>            <label for="psw"><b>Password</b></label>            <input type="password" placeholder="Enter Password" name="password" id="password" required>            <select name="security" id="secmode">                <option value="0">No Sanitization</option>                <option value="1">Sanitized</option>            </select>            <button type="submit" class="action-button">Login</button>            <button type="submit" class="action-button" data-action="show_query.php">Print Results</button>        </div>    </form>    </body>    </html><script>    $(function() {        $(".action-button").click( function() {            $('#form').attr('action', $(this).data("action"));            $('#form').submit();        });    });    function fetch_query(username,password,secmode)    {        fetch("http://<?=$SERVER_HOST?>/print_query_raw.php",{            method:"POST",            headers:{                "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8"            },            body:"username=" + username + "&password=" + password + "&security=" + secmode        }).then(            (response)=>response.text()        ).then(            (res)=>{                document.getElementById("query").innerHTML=res            }        );    }    user = document.getElementById("username");    pass = document.getElementById("password");    security = document.getElementById("secmode");    $("#username").change(()=>{       fetch_query(user.value,pass.value,security.value);    });    $("#password").change(()=>{       fetch_query(user.value,pass.value,security.value);    });    $("#secmode").change(()=>{        fetch_query(user.value,pass.value,security.value);    });    window.onload=fetch_query(user.value,pass.value,security.value);</script>